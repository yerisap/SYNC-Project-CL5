<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8" />
<title>ZEA_FI030_F01</title>
<style type="text/css">
.code{ font-family:"Courier New", Courier, monospace; color:#000; font-size:14px; background-color:#F2F4F7 }
  .codeComment {font-family:"Courier New", Courier, monospace; color:#0000F0; font-size:14px; background-color:#F2F4F7 }
  .normalBold{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px; font-weight:800 }
  .normalBoldLarge{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:16px; font-weight:800 }
</style>
<style type="text/css">
  .normal{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px }
  .footer{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px; text-align: center }
  h2{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:16px; font-weight:800 }
  h3{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:14px; font-weight:800 }
  .outerTable{
   background-color:#E0E7ED;
   width:100%;
   border-top-width: thin;
   border-right-width: thin;
   border-right-width: thin;
   border-left-width: thin;
   border-top-style: solid;
   border-right-style: solid;
   border-bottom-style: solid;
   border-left-style: solid;
  }
  .innerTable{
   background-color:#F2F4F7;
   width:100%;
   border-top-width: thin;
   border-right-width: thin;
   border-bottom-width: thin;
   border-left-width: thin;
   border-top-style: solid;
   border-right-style: solid;
   border-bottom-style: solid;
   border-left-style: solid;
  }
</style>
</head>
<body>
<table class="outerTable">
  <tr class="normalBoldLarge">
     <td><h2>Code listing for: ZEA_FI030_F01</h2>
<h3> Description: Include ZEA_GL_DISPLAY_F01</h3></td>
   </tr>
  <tr>
     <td>
     <table class="innerTable">
       <tr>
          <td>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Include&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZEA_GL_DISPLAY_F01<br />
*&---------------------------------------------------------------------*<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;CREATE_OBJECT<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM CREATE_OBJECT .<br />
   </div>
   <div class="codeComment">
***&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;GO_CONTAINER<br />
***&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTAINER_NAME&nbsp;=&nbsp;'CCON_ITEM'.<br />
***&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;메세지&nbsp;구현&nbsp;필요<br />
***&nbsp;&nbsp;ENDIF.<br />
***<br />
***&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;GO_ALV_GRID<br />
***&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_PARENT&nbsp;=&nbsp;GO_CONTAINER.<br />
***&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;메세지&nbsp;구현&nbsp;필요<br />
***&nbsp;&nbsp;ENDIF.<br />
<br />
*--&nbsp;Create&nbsp;Container<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;GO_CONTAINER<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REPID&nbsp;=&nbsp;SY-REPID<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DYNNR&nbsp;=&nbsp;SY-DYNNR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SIDE&nbsp;&nbsp;=&nbsp;GO_CONTAINER-&gt;DOCK_AT_RIGHT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RATIO&nbsp;=&nbsp;60.<br />
<br />
<br />
&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;GO_ALV_GRID<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_PARENT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GO_CONTAINER<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_APPL_EVENTS&nbsp;=&nbsp;'X'.&nbsp;"&nbsp;Register&nbsp;Events&nbsp;as&nbsp;Application&nbsp;Events<br />
<br />
   </div>
   <div class="codeComment">
*--&nbsp;Create&nbsp;TOP-Document<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;GO_DYNDOC_ID<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STYLE&nbsp;=&nbsp;'ALV_GRID'.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;ALV_LAYOUT_0100<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM ALV_LAYOUT_0100 .<br />
<br />
&nbsp;&nbsp;GV_SAVE&nbsp;=&nbsp;'A'.<br />
&nbsp;&nbsp;GS_VARIANT-REPORT&nbsp;=&nbsp;SY-REPID.<br />
<br />
&nbsp;&nbsp;GS_LAYOUT-ZEBRA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ABAP_ON.&nbsp;"&nbsp;얼룩&nbsp;색상&nbsp;처리<br />
&nbsp;&nbsp;GS_LAYOUT-CWIDTH_OPT&nbsp;=&nbsp;'A'.&nbsp;"&nbsp;열&nbsp;넓이&nbsp;최적화<br />
&nbsp;&nbsp;GS_LAYOUT-SEL_MODE&nbsp;&nbsp;&nbsp;=&nbsp;'D'.&nbsp;"&nbsp;D:&nbsp;셀&nbsp;단위&nbsp;선택<br />
&nbsp;&nbsp;GS_LAYOUT-GRID_TITLE&nbsp;=&nbsp;'임시&nbsp;전표&nbsp;항목'.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;ALV_FIELDCAT_0100<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM ALV_FIELDCAT_0100 .<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_FIELDCAT.<br />
&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;=&nbsp;'ITNUM'.<br />
&nbsp;&nbsp;GS_FIELDCAT-REF_TABLE&nbsp;=&nbsp;'ZEA_BSEG'.<br />
&nbsp;&nbsp;GS_FIELDCAT-REF_FIELD&nbsp;=&nbsp;'ITNUM'.<br />
&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;&nbsp;&nbsp;=&nbsp;'항목'.<br />
&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;=&nbsp;10.<br />
&nbsp;&nbsp;GS_FIELDCAT-KEY&nbsp;=&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_FIELDCAT.<br />
&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;=&nbsp;'BSCHL'.<br />
&nbsp;&nbsp;GS_FIELDCAT-REF_TABLE&nbsp;=&nbsp;'ZEA_BSEG'.<br />
&nbsp;&nbsp;GS_FIELDCAT-REF_FIELD&nbsp;=&nbsp;'BSCHL'.<br />
&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;=&nbsp;5.<br />
&nbsp;&nbsp;GS_FIELDCAT-KEY&nbsp;=&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_FIELDCAT.<br />
&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;=&nbsp;'GLTXT'.<br />
&nbsp;&nbsp;GS_FIELDCAT-REF_TABLE&nbsp;=&nbsp;'ZEA_BSEG'.<br />
&nbsp;&nbsp;GS_FIELDCAT-REF_FIELD&nbsp;=&nbsp;'GLTXT'.<br />
&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;=&nbsp;30.<br />
&nbsp;&nbsp;GS_FIELDCAT-KEY&nbsp;=&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_FIELDCAT.<br />
&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;=&nbsp;'DMBTR'.<br />
&nbsp;&nbsp;GS_FIELDCAT-REF_TABLE&nbsp;=&nbsp;'ZEA_BSEG'.<br />
&nbsp;&nbsp;GS_FIELDCAT-REF_FIELD&nbsp;=&nbsp;'DMBTR'.<br />
&nbsp;&nbsp;GS_FIELDCAT-EMPHASIZE&nbsp;=&nbsp;'C311'.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_FIELDCAT.<br />
&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;=&nbsp;'D_WAERS'.<br />
&nbsp;&nbsp;GS_FIELDCAT-REF_TABLE&nbsp;=&nbsp;'ZEA_BSEG'.<br />
&nbsp;&nbsp;GS_FIELDCAT-REF_FIELD&nbsp;=&nbsp;'D_WAERS'.<br />
&nbsp;&nbsp;GS_FIELDCAT-EMPHASIZE&nbsp;=&nbsp;'C311'.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_FIELDCAT.<br />
&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;=&nbsp;'WRBTR'.<br />
&nbsp;&nbsp;GS_FIELDCAT-REF_TABLE&nbsp;=&nbsp;'ZEA_BSEG'.<br />
&nbsp;&nbsp;GS_FIELDCAT-REF_FIELD&nbsp;=&nbsp;'WRBTR'.<br />
&nbsp;&nbsp;GS_FIELDCAT-EMPHASIZE&nbsp;=&nbsp;'C311'.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_FIELDCAT.<br />
&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;=&nbsp;'W_WAERS'.<br />
&nbsp;&nbsp;GS_FIELDCAT-REF_TABLE&nbsp;=&nbsp;'ZEA_BSEG'.<br />
&nbsp;&nbsp;GS_FIELDCAT-REF_FIELD&nbsp;=&nbsp;'W_WAERS'.<br />
&nbsp;&nbsp;GS_FIELDCAT-EMPHASIZE&nbsp;=&nbsp;'C311'.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_FIELDCAT.<br />
&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;=&nbsp;'INDI_CD'.<br />
&nbsp;&nbsp;GS_FIELDCAT-REF_TABLE&nbsp;=&nbsp;'ZEA_TBSL'.<br />
&nbsp;&nbsp;GS_FIELDCAT-REF_FIELD&nbsp;=&nbsp;'INDI_CD'.<br />
&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;&nbsp;&nbsp;=&nbsp;'차대'.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;ALV_EVENT_0100<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM ALV_EVENT_0100 .<br />
&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;LCL_EVENT_HANDLER=&gt;ON_TOOLBAR&nbsp;FOR&nbsp;GO_ALV_GRID.<br />
&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;LCL_EVENT_HANDLER=&gt;ON_USER_COMMAND&nbsp;FOR&nbsp;GO_ALV_GRID.<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;ALV_DISPLAY_0100<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM ALV_DISPLAY_0100 .<br />
<br />
&nbsp;&nbsp;GO_ALV_GRID-&gt;SET_TABLE_FOR_FIRST_DISPLAY(<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_STRUCTURE_NAME&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'ZEA_BSEG'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IS_VARIANT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GS_VARIANT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_SAVE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'A'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_DEFAULT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'X'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IS_LAYOUT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GS_LAYOUT<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_TOOLBAR_EXCLUDING&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GT_UI_FUNCTIONS<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;CHANGING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_OUTTAB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GT_DATA<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_FIELDCATALOG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GT_FIELDCAT<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_SORT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_FILTER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INVALID_PARAMETER_COMBINATION&nbsp;=&nbsp;1<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PROGRAM_ERROR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TOO_MANY_LINES&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;3<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;4<br />
   </div>
   <div class="code">
&nbsp;&nbsp;).<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;메세지&nbsp;구현&nbsp;필요<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;SELECT_DATA<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM SELECT_DATA .<br />
<br />
&nbsp;&nbsp;"&nbsp;전기키<br />
&nbsp;&nbsp;SELECT&nbsp;*&nbsp;FROM&nbsp;ZEA_TBSL&nbsp;INTO&nbsp;TABLE&nbsp;GT_TBSL.<br />
<br />
&nbsp;&nbsp;"&nbsp;환율<br />
&nbsp;&nbsp;SELECT&nbsp;*&nbsp;FROM&nbsp;ZEA_TCURR&nbsp;INTO&nbsp;TABLE&nbsp;GT_TCURR.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;MAKE_DISPLAY_DATA<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM MAKE_DISPLAY_DATA .<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;DISPLAY_DATA<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM DISPLAY_DATA .<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;DESCRIBE&nbsp;TABLE&nbsp;GT_BSEG.<br />
*&nbsp;&nbsp;MESSAGE&nbsp;S005&nbsp;WITH&nbsp;SY-TFILL.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CALL&nbsp;SCREEN&nbsp;200.<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;INIT_DATA<br />
*&&nbsp;ZEA_BKPF&nbsp;:&nbsp;헤더&nbsp;/&nbsp;ZEA_BSEG&nbsp;:&nbsp;아이템<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM INIT_DATA .<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;--&nbsp;200&nbsp;번&nbsp;화면&nbsp;(Header)&nbsp;--------------------------<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ZEA_BSEG-D_WAERS&nbsp;=&nbsp;'KRW'.&nbsp;"&nbsp;통화코드&nbsp;초기설정<br />
<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;--&nbsp;&nbsp;200번&nbsp;화면의&nbsp;disable&nbsp;입력필드에&nbsp;값&nbsp;전달<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ZEA_BKPF-BUKRS&nbsp;=&nbsp;1000.<br />
&nbsp;&nbsp;ZEA_BKPF-GJAHR&nbsp;=&nbsp;SY-DATUM+0(4).<br />
&nbsp;&nbsp;ZEA_BKPF-BLDAT&nbsp;=&nbsp;SY-DATUM.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;증빙일자&nbsp;=&nbsp;오늘날짜<br />
&nbsp;&nbsp;ZEA_BKPF-BUDAT&nbsp;=&nbsp;SY-DATUM.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;전기일자&nbsp;=&nbsp;오늘날짜<br />
&nbsp;&nbsp;ZEA_BKPF-ERDAT&nbsp;=&nbsp;SY-DATUM.<br />
&nbsp;&nbsp;ZEA_BKPF-ERZET&nbsp;=&nbsp;SY-UZEIT.<br />
&nbsp;&nbsp;ZEA_TCURR-GDATU&nbsp;=&nbsp;SY-DATUM.<br />
<br />
&nbsp;&nbsp;"&nbsp;200번&nbsp;헤더에서&nbsp;입력한&nbsp;전기키를&nbsp;Search&nbsp;Help를&nbsp;사용하기&nbsp;위해&nbsp;값&nbsp;전달<br />
&nbsp;&nbsp;ZEA_BSEG-BSCHL&nbsp;=&nbsp;ZEA_TBSL-BSCHL.<br />
<br />
&nbsp;&nbsp;"&nbsp;200번&nbsp;화면에서&nbsp;전기키,&nbsp;계정코드를&nbsp;입력하기&nbsp;위한&nbsp;초기&nbsp;조건<br />
&nbsp;&nbsp;ZEA_BSEG-BUKRS&nbsp;=&nbsp;1000.<br />
&nbsp;&nbsp;ZEA_BSEG-GJAHR&nbsp;=&nbsp;SY-DATUM+0(4).<br />
&nbsp;&nbsp;ZEA_BKPF-ERNAM&nbsp;=&nbsp;SY-UNAME.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;CASE&nbsp;SY-UNAME.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'ACA5-03'.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZEA_BKPF-ERNAM&nbsp;=&nbsp;'김건우'.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'ACA5-07'.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZEA_BKPF-ERNAM&nbsp;=&nbsp;'김연범'.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'ACA5-08'.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZEA_BKPF-ERNAM&nbsp;=&nbsp;'김예리'.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'ACA5-10'.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZEA_BKPF-ERNAM&nbsp;=&nbsp;'김혜진'.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'ACA5-12'.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZEA_BKPF-ERNAM&nbsp;=&nbsp;'박지영'.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'ACA5-15'.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZEA_BKPF-ERNAM&nbsp;=&nbsp;'유연수'.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'ACA5-17'.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZEA_BKPF-ERNAM&nbsp;=&nbsp;'이세영'.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'ACA5-23'.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZEA_BKPF-ERNAM&nbsp;=&nbsp;'조병석'.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'ACA-05'.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZEA_BKPF-ERNAM&nbsp;=&nbsp;'정훈영'.<br />
*&nbsp;&nbsp;ENDCASE.<br />
<br />
*&nbsp;&nbsp;글씨&nbsp;색상변경<br />
   </div>
   <div class="code">
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;SCREEN.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;SCREEN-GROUP1&nbsp;=&nbsp;'BLU'.&nbsp;&nbsp;"해당&nbsp;파라미터&nbsp;text&nbsp;의&nbsp;스크린네임<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SCREEN-INTENSIFIED&nbsp;=&nbsp;'1'.&nbsp;&nbsp;&nbsp;&nbsp;"1&nbsp;값이면&nbsp;활성화&nbsp;(파란색)<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;SCREEN.<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;SAVE_HEADER_DATA<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM SAVE_HEADER_DATA .<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_BKPF.<br />
&nbsp;&nbsp;REFRESH&nbsp;GT_BKPF.<br />
<br />
&nbsp;&nbsp;GS_BKPF-AEDAT&nbsp;=&nbsp;SY-DATUM.<br />
&nbsp;&nbsp;GS_BKPF-AENAM&nbsp;=&nbsp;SY-UNAME.<br />
&nbsp;&nbsp;GS_BKPF-AEZET&nbsp;=&nbsp;SY-UZEIT.<br />
<br />
&nbsp;&nbsp;"&nbsp;ZEA_BKPF&nbsp;화면에&nbsp;입력한&nbsp;값을&nbsp;내부&nbsp;변수에&nbsp;전달<br />
&nbsp;&nbsp;MOVE-CORRESPONDING&nbsp;ZEA_BKPF&nbsp;TO&nbsp;GS_BKPF.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_BKPF&nbsp;TO&nbsp;GT_BKPF.<br />
<br />
&nbsp;&nbsp;GV_ITNUM&nbsp;=&nbsp;0.&nbsp;&nbsp;"&nbsp;전표Line&nbsp;번호&nbsp;초기화<br />
&nbsp;&nbsp;ZEA_BSEG-BELNR&nbsp;=&nbsp;GS_BKPF-BELNR.&nbsp;"&nbsp;전표번호&nbsp;Item&nbsp;에&nbsp;전달<br />
&nbsp;&nbsp;ZEA_BSEG-BUKRS&nbsp;=&nbsp;GS_BKPF-BUKRS.&nbsp;"&nbsp;회계연도&nbsp;Item&nbsp;에&nbsp;전달<br />
<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;SAVE_ITEM_DATA<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM SAVE_ITEM_DATA .<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_DATA.<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_BSEG.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;REFRESH&nbsp;GT_BSEG.&nbsp;&lt;==&nbsp;REFRESH&nbsp;시,&nbsp;ALV에&nbsp;신규&nbsp;데이터&nbsp;1줄만&nbsp;보인다.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;DATA:&nbsp;LV_INDI_CD&nbsp;TYPE&nbsp;ZEA_TBSL-INDI_CD.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;--&nbsp;G/L&nbsp;계정,&nbsp;전기키가&nbsp;같으면&nbsp;입력방지<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;"&nbsp;GS_DATA&nbsp;에&nbsp;값이&nbsp;안들어오는&nbsp;경우가&nbsp;있음.&nbsp;전기키가&nbsp;00&nbsp;이라고&nbsp;보임.<br />
&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;GT_DATA&nbsp;INTO&nbsp;GS_DATA&nbsp;WITH&nbsp;KEY&nbsp;SAKNR&nbsp;=&nbsp;ZEA_BSEG-SAKNR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BSCHL&nbsp;=&nbsp;ZEA_TBSL-BSCHL.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;IF&nbsp;GS_DATA-BSCHL&nbsp;EQ&nbsp;ZEA_TBSL-BSCHL&nbsp;AND&nbsp;GS_DATA-SAKNR&nbsp;EQ&nbsp;ZEA_BSEG-SAKNR.&nbsp;(GT_DATA로&nbsp;변경)<br />
   </div>
   <div class="code">
&nbsp;&nbsp;IF&nbsp;GS_DATA-BSCHL&nbsp;EQ&nbsp;ZEA_TBSL-BSCHL&nbsp;AND&nbsp;GS_DATA-SAKNR&nbsp;EQ&nbsp;ZEA_BSEG-SAKNR.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;S122&nbsp;DISPLAY&nbsp;LIKE&nbsp;'W'.&nbsp;"&nbsp;동일한&nbsp;데이터가&nbsp;존재합니다.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;입력&nbsp;가능<br />
&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;GLTXT&nbsp;FROM&nbsp;ZEA_SKB1&nbsp;INTO&nbsp;LV_GLTXT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;SAKNR&nbsp;EQ&nbsp;ZEA_BSEG-SAKNR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;BUKRS&nbsp;EQ&nbsp;1000.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;CHECK<br />
&nbsp;&nbsp;&nbsp;&nbsp;CASE&nbsp;ZEA_BSEG-GLTXT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;LV_GLTXT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;OTHERS.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;GLTXT&nbsp;FROM&nbsp;ZEA_SKB1&nbsp;INTO&nbsp;LV_GLTXT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;SAKNR&nbsp;EQ&nbsp;ZEA_BSEG-SAKNR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;BUKRS&nbsp;EQ&nbsp;1000.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZEA_BSEG-GLTXT&nbsp;=&nbsp;LV_GLTXT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDCASE.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;--&nbsp;1.&nbsp;item&nbsp;line&nbsp;부여&nbsp;------------------------------------------------*<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;GV_ITNUM&nbsp;=&nbsp;GV_ITNUM&nbsp;+&nbsp;1.&nbsp;"&nbsp;전표Line<br />
&nbsp;&nbsp;&nbsp;&nbsp;ZEA_BSEG-ITNUM&nbsp;=&nbsp;GV_ITNUM.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;--&nbsp;2.&nbsp;ZEA_BSEG&nbsp;화면에&nbsp;입력한&nbsp;값을&nbsp;내부&nbsp;변수에&nbsp;전달&nbsp;------------------*<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;ZEA_BSEG-BSCHL&nbsp;=&nbsp;ZEA_TBSL-BSCHL.&nbsp;"&nbsp;전기키&nbsp;전달<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;ZEA_BSEG-DMBTR&nbsp;=&nbsp;*&nbsp;값&nbsp;입력&nbsp;시,&nbsp;차액&nbsp;금액이&nbsp;자동으로&nbsp;입력되도록<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;문제점&nbsp;:&nbsp;마지막&nbsp;라인이&nbsp;세금&nbsp;코드&nbsp;인경우,&nbsp;차액&nbsp;/&nbsp;1.1&nbsp;한&nbsp;금액을&nbsp;반영해줘야함.&nbsp;(2024.05.12&nbsp;-&nbsp;해결완료)<br />
<br />
   </div>
   <div class="codeComment">
***&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;2024.05.14<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;ZEA_BSEG-DMBTR&nbsp;EQ&nbsp;S0100-DIFFERENC&nbsp;AND&nbsp;S0100-TAX&nbsp;EQ&nbsp;ABAP_OFF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZEA_BSEG-DMBTR&nbsp;=&nbsp;ABS(&nbsp;S0100-DIFFERENC&nbsp;).<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZEA_BSEG-WRBTR&nbsp;=&nbsp;ABS(&nbsp;S0100-DIFFERENC&nbsp;).<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;ZEA_BSEG-DMBTR&nbsp;EQ&nbsp;S0100-DIFFERENC&nbsp;AND&nbsp;S0100-TAX&nbsp;EQ&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;입력이&nbsp;안되도록.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;--&nbsp;3.&nbsp;전표통화금액&nbsp;-&gt;&nbsp;환율계산&nbsp;--------------------------------------*<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;CASE&nbsp;ZEA_BSEG-D_WAERS.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;1)&nbsp;KRW&nbsp;-&gt;&nbsp;KRW<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'KRW'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;ZEA_BSEG-DMBTR&nbsp;=&nbsp;사용자&nbsp;금액&nbsp;입력필드명<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZEA_BSEG-WRBTR&nbsp;&nbsp;&nbsp;=&nbsp;ZEA_BSEG-DMBTR.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZEA_BSEG-W_WAERS&nbsp;=&nbsp;ZEA_BSEG-D_WAERS.&nbsp;"&nbsp;KRW(통화코드)&nbsp;전달<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;2)&nbsp;KRW&nbsp;이외&nbsp;외화<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;OTHERS.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;KRW으로&nbsp;환산금액&nbsp;&nbsp;=&nbsp;금액&nbsp;입력값&nbsp;*&nbsp;환율&nbsp;/&nbsp;100.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZEA_BSEG-WRBTR&nbsp;&nbsp;&nbsp;=&nbsp;ZEA_BSEG-DMBTR&nbsp;*&nbsp;GS_TCURR-UKURS&nbsp;/&nbsp;100.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZEA_BSEG-W_WAERS&nbsp;=&nbsp;'KRW'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDCASE.<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;MOVE-CORRESPONDING&nbsp;ZEA_BSEG&nbsp;TO&nbsp;GS_DATA.<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;GS_DATA&nbsp;TO&nbsp;GT_DATA.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;--&nbsp;4.&nbsp;세금&nbsp;계산&nbsp;&&nbsp;차/대변&nbsp;합계&nbsp;계산&nbsp;&&nbsp;STATUS&nbsp;ICON&nbsp;설정<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;CALCULATION_DATA.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;--&nbsp;5.&nbsp;화면변수(GT_DATA)로&nbsp;값&nbsp;전달<br />
*&nbsp;&nbsp;&nbsp;&nbsp;MOVE-CORRESPONDING&nbsp;GT_BSEG&nbsp;TO&nbsp;GT_DATA.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;전기키&nbsp;테이블로&nbsp;S/H&nbsp;구분<br />
&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;GT_DATA&nbsp;INTO&nbsp;GS_DATA.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;GT_TBSL&nbsp;INTO&nbsp;GS_TBSL&nbsp;WITH&nbsp;KEY&nbsp;BSCHL&nbsp;=&nbsp;GS_DATA-BSCHL.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DATA-INDI_CD&nbsp;=&nbsp;GS_TBSL-INDI_CD.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;GT_DATA&nbsp;FROM&nbsp;GS_DATA.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;ALV&nbsp;Refresh<br />
&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;REFRESH_TABLE.<br />
<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;--&nbsp;금액&nbsp;필드&nbsp;초기화<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:&nbsp;ZEA_BSEG-DMBTR.&nbsp;"&nbsp;금액필드&nbsp;초기화<br />
&nbsp;&nbsp;&nbsp;&nbsp;S0100-TAX&nbsp;=&nbsp;ABAP_OFF.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;NUMBER_ZEA_BELNR<br />
*&&nbsp;전표번호&nbsp;RANGE&nbsp;변수&nbsp;생성<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM NR_ZEA_BELNR CHANGING CV_BELNR_NUMBER.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;LV_RC&nbsp;TYPE&nbsp;INRI-RETURNCODE.<br />
<br />
&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'NUMBER_GET_NEXT'<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NR_RANGE_NR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'01'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;NR에&nbsp;지정한&nbsp;No<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'ZEA_BELNR'&nbsp;&nbsp;&nbsp;"&nbsp;number&nbsp;range&nbsp;obj&nbsp;명<br />
&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NUMBER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;CV_BELNR_NUMBER<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURNCODE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;LV_RC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;저장할&nbsp;변수.<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTERVAL_NOT_FOUND&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NUMBER_RANGE_NOT_INTERN&nbsp;=&nbsp;2<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT_NOT_FOUND&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;3<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;QUANTITY_IS_0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;4<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;QUANTITY_IS_NOT_1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;5<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTERVAL_OVERFLOW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;6<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BUFFER_OVERFLOW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;7<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;ENDIF.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;WRITE:&nbsp;CV_BELNR_NUMBER.<br />
   </div>
   <div class="code">
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;CALCULATION_DATA<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM CALCULATION_DATA .<br />
<br />
&nbsp;&nbsp;REFRESH&nbsp;GT_TBSL.<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_TBSL.<br />
<br />
&nbsp;&nbsp;SELECT&nbsp;*&nbsp;FROM&nbsp;ZEA_TBSL&nbsp;INTO&nbsp;TABLE&nbsp;GT_TBSL.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;--&nbsp;전기키&nbsp;테이블로&nbsp;차/대&nbsp;구분<br />
   </div>
   <div class="code">
&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;GT_TBSL&nbsp;INTO&nbsp;GS_TBSL&nbsp;WITH&nbsp;KEY&nbsp;BSCHL&nbsp;=&nbsp;ZEA_BSEG-BSCHL.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;--&nbsp;세금&nbsp;계산&nbsp;(KRW,&nbsp;외화코드&nbsp;반영&nbsp;O)<br />
   </div>
   <div class="code">
&nbsp;&nbsp;IF&nbsp;S0100-TAX&nbsp;EQ&nbsp;ABAP_ON&nbsp;AND&nbsp;ZEA_BSEG-D_WAERS&nbsp;EQ&nbsp;'KRW'.&nbsp;"&nbsp;10%&nbsp;부가세&nbsp;라인을&nbsp;한&nbsp;줄&nbsp;더&nbsp;생성한다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CASE&nbsp;GS_TBSL-INDI_CD.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'S'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;전표Line&nbsp;추가<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GV_ITNUM&nbsp;=&nbsp;GV_ITNUM&nbsp;+&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DATA-ITNUM&nbsp;=&nbsp;GV_ITNUM.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DATA-BSCHL&nbsp;=&nbsp;ZEA_BSEG-BSCHL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DATA-SAKNR&nbsp;=&nbsp;'210200'.&nbsp;"&nbsp;부가세&nbsp;예수금&nbsp;(매출&nbsp;-&nbsp;S)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DATA-GLTXT&nbsp;=&nbsp;'부가세&nbsp;예수금'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DATA-DMBTR&nbsp;=&nbsp;ZEA_BSEG-DMBTR&nbsp;/&nbsp;10.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DATA-D_WAERS&nbsp;=&nbsp;ZEA_BSEG-D_WAERS.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DATA-WRBTR&nbsp;=&nbsp;ZEA_BSEG-DMBTR&nbsp;/&nbsp;10.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DATA-W_WAERS&nbsp;=&nbsp;'KRW'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;GS_DATA&nbsp;TO&nbsp;GT_DATA.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'H'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;전표Line&nbsp;추가<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GV_ITNUM&nbsp;=&nbsp;GV_ITNUM&nbsp;+&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DATA-ITNUM&nbsp;=&nbsp;GV_ITNUM.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DATA-BSCHL&nbsp;=&nbsp;ZEA_BSEG-BSCHL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DATA-SAKNR&nbsp;=&nbsp;'210210'.&nbsp;"&nbsp;부가세&nbsp;대급금&nbsp;(매입&nbsp;-&nbsp;H)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DATA-GLTXT&nbsp;=&nbsp;'부가세&nbsp;대급금'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DATA-DMBTR&nbsp;=&nbsp;ZEA_BSEG-DMBTR&nbsp;/&nbsp;10.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DATA-D_WAERS&nbsp;=&nbsp;ZEA_BSEG-D_WAERS.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DATA-WRBTR&nbsp;=&nbsp;ZEA_BSEG-DMBTR&nbsp;/&nbsp;10.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DATA-W_WAERS&nbsp;=&nbsp;'KRW'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;GS_DATA&nbsp;TO&nbsp;GT_DATA.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDCASE.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;통화코드가&nbsp;KRW&nbsp;가&nbsp;아닐&nbsp;경우,&nbsp;세금도&nbsp;원화환산이&nbsp;필요하다.<br />
&nbsp;&nbsp;ELSEIF&nbsp;S0100-TAX&nbsp;EQ&nbsp;ABAP_ON&nbsp;AND&nbsp;ZEA_BSEG-D_WAERS&nbsp;NE&nbsp;'KRW'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;CASE&nbsp;GS_TBSL-INDI_CD.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'S'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;전표Line&nbsp;추가<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GV_ITNUM&nbsp;=&nbsp;GV_ITNUM&nbsp;+&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DATA-ITNUM&nbsp;=&nbsp;GV_ITNUM.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DATA-BSCHL&nbsp;=&nbsp;ZEA_BSEG-BSCHL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DATA-SAKNR&nbsp;=&nbsp;'210200'.&nbsp;"&nbsp;부가세&nbsp;예수금&nbsp;(매출&nbsp;-&nbsp;S)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DATA-GLTXT&nbsp;=&nbsp;'부가세&nbsp;예수금'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DATA-DMBTR&nbsp;=&nbsp;ZEA_BSEG-DMBTR&nbsp;/&nbsp;10.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DATA-D_WAERS&nbsp;=&nbsp;ZEA_BSEG-D_WAERS.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DATA-WRBTR&nbsp;=&nbsp;(&nbsp;ZEA_BSEG-DMBTR&nbsp;*&nbsp;GS_TCURR-UKURS&nbsp;/&nbsp;100&nbsp;)&nbsp;/&nbsp;10.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DATA-W_WAERS&nbsp;=&nbsp;'KRW'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;GS_DATA&nbsp;TO&nbsp;GT_DATA.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'H'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;전표Line&nbsp;추가<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GV_ITNUM&nbsp;=&nbsp;GV_ITNUM&nbsp;+&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DATA-ITNUM&nbsp;=&nbsp;GV_ITNUM.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DATA-BSCHL&nbsp;=&nbsp;ZEA_BSEG-BSCHL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DATA-SAKNR&nbsp;=&nbsp;'210210'.&nbsp;"&nbsp;부가세&nbsp;대급금&nbsp;(매입&nbsp;-&nbsp;H)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DATA-GLTXT&nbsp;=&nbsp;'부가세&nbsp;대급금'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DATA-DMBTR&nbsp;=&nbsp;ZEA_BSEG-DMBTR&nbsp;/&nbsp;10.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DATA-D_WAERS&nbsp;=&nbsp;ZEA_BSEG-D_WAERS.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DATA-WRBTR&nbsp;=&nbsp;(&nbsp;ZEA_BSEG-DMBTR&nbsp;*&nbsp;GS_TCURR-UKURS&nbsp;/&nbsp;100&nbsp;)&nbsp;/&nbsp;10.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DATA-W_WAERS&nbsp;=&nbsp;'KRW'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;GS_DATA&nbsp;TO&nbsp;GT_DATA.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDCASE.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
<br />
&nbsp;&nbsp;"&nbsp;차변합계&nbsp;/&nbsp;대변합계&nbsp;구하는&nbsp;로직<br />
&nbsp;&nbsp;CASE&nbsp;GS_TBSL-INDI_CD.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'S'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CASE&nbsp;S0100-TAX.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S0100-SUM_S&nbsp;=&nbsp;S0100-SUM_S&nbsp;+&nbsp;(&nbsp;ZEA_BSEG-DMBTR&nbsp;*&nbsp;11&nbsp;/&nbsp;10&nbsp;).<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;OTHERS.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S0100-SUM_S&nbsp;=&nbsp;S0100-SUM_S&nbsp;+&nbsp;ZEA_BSEG-DMBTR.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDCASE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'H'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CASE&nbsp;S0100-TAX.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S0100-SUM_H&nbsp;=&nbsp;S0100-SUM_H&nbsp;+&nbsp;(&nbsp;ZEA_BSEG-DMBTR&nbsp;*&nbsp;11&nbsp;/&nbsp;10&nbsp;).<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;OTHERS.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S0100-SUM_H&nbsp;=&nbsp;S0100-SUM_H&nbsp;+&nbsp;ZEA_BSEG-DMBTR.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDCASE.<br />
&nbsp;&nbsp;ENDCASE.<br />
<br />
&nbsp;&nbsp;S0100-DIFFERENC&nbsp;=&nbsp;S0100-SUM_S&nbsp;-&nbsp;S0100-SUM_H.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;--&nbsp;icon&nbsp;설정<br />
   </div>
   <div class="code">
&nbsp;&nbsp;IF&nbsp;&nbsp;S0100-DIFFERENC&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'ICON_CREATE'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NAME&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ICON_LED_GREEN<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'대차&nbsp;일치'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RESULT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;STATUS_ICON<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ICON_NOT_FOUND&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1&nbsp;"&nbsp;Icon&nbsp;name&nbsp;unknown&nbsp;to&nbsp;system<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OUTPUTFIELD_TOO_SHORT&nbsp;=&nbsp;2&nbsp;"&nbsp;Length&nbsp;of&nbsp;field&nbsp;'RESULT'&nbsp;is&nbsp;too&nbsp;small<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;3.<br />
<br />
&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'ICON_CREATE'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NAME&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ICON_LED_RED<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'대차&nbsp;불일치'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RESULT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;STATUS_ICON<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ICON_NOT_FOUND&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1&nbsp;"&nbsp;Icon&nbsp;name&nbsp;unknown&nbsp;to&nbsp;system<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OUTPUTFIELD_TOO_SHORT&nbsp;=&nbsp;2.&nbsp;"&nbsp;Length&nbsp;of&nbsp;field&nbsp;'RESULT'&nbsp;is&nbsp;too&nbsp;small<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;MODIFY&nbsp;SCREEN.<br />
&nbsp;&nbsp;PERFORM&nbsp;REFRESH_TABLE.<br />
<br />
   </div>
   <div class="codeComment">
**&nbsp;&nbsp;--&nbsp;전표&nbsp;자동&nbsp;저장<br />
*&nbsp;&nbsp;IF&nbsp;S0100-SUM_S&nbsp;NE&nbsp;0&nbsp;AND&nbsp;S0100-SUM_H&nbsp;NE&nbsp;0&nbsp;AND&nbsp;S0100-DIFFERENC&nbsp;=&nbsp;0.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;OK_CODE&nbsp;=&nbsp;'SAVE'.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;SAVE_ALL_DATA.<br />
*&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
   </div>
   <div class="code">
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;REFRESH_TABLE<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM REFRESH_TABLE .<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;GO_ALV_GRID-&gt;REFRESH_TABLE_DISPLAY(&nbsp;).<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;SAVE_TABLE<br />
*&&nbsp;차/대변&nbsp;일치&nbsp;시에만&nbsp;저장이&nbsp;가능하다.<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM SAVE_TABLE .<br />
<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;GO_ALV_GRID-&gt;CHECK_CHANGED_DATA.&nbsp;"&nbsp;바뀐&nbsp;데이터&nbsp;여부&nbsp;체크<br />
<br />
&nbsp;&nbsp;MOVE-CORRESPONDING&nbsp;GT_DATA&nbsp;TO&nbsp;GT_BSEG.<br />
<br />
&nbsp;&nbsp;PERFORM&nbsp;NR_ZEA_BELNR&nbsp;CHANGING&nbsp;GV_BELNR_NUMBER.&nbsp;"&nbsp;NR_전표번호&nbsp;부여<br />
<br />
&nbsp;&nbsp;"&nbsp;100번&nbsp;스크린에&nbsp;값을&nbsp;전달<br />
&nbsp;&nbsp;ZEA_BKPF-BELNR&nbsp;=&nbsp;GV_BELNR_NUMBER.&nbsp;"&nbsp;전표번호&nbsp;Range<br />
&nbsp;&nbsp;ZEA_BSEG-BELNR&nbsp;=&nbsp;GV_BELNR_NUMBER.&nbsp;"&nbsp;전표번호&nbsp;Range<br />
<br />
&nbsp;&nbsp;"&nbsp;내부&nbsp;변수에&nbsp;채번된&nbsp;전표번호&nbsp;값&nbsp;전달<br />
&nbsp;&nbsp;GS_BKPF-BELNR&nbsp;=&nbsp;GV_BELNR_NUMBER.&nbsp;"&nbsp;헤더<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;GT_BSEG&nbsp;INTO&nbsp;GS_BSEG.&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;아이템<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_BSEG-BELNR&nbsp;=&nbsp;GV_BELNR_NUMBER.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;GT_BSEG&nbsp;FROM&nbsp;GS_BSEG.<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;MODIFY&nbsp;ZEA_BKPF&nbsp;FROM&nbsp;GS_BKPF.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;헤더&nbsp;테이블<br />
&nbsp;&nbsp;MODIFY&nbsp;ZEA_BSEG&nbsp;FROM&nbsp;TABLE&nbsp;GT_BSEG.&nbsp;"&nbsp;아이템&nbsp;테이블<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;--&nbsp;&nbsp;전표유형에&nbsp;따라&nbsp;고객원장/벤더원장&nbsp;테이블로&nbsp;데이터&nbsp;저장<br />
*&nbsp;ZEA_FIT700&nbsp;:&nbsp;'D*'.<br />
*&nbsp;ZEA_FIT800&nbsp;:&nbsp;'K*'.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CASE&nbsp;GS_BKPF-BLART.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'DA'&nbsp;OR&nbsp;'DG'&nbsp;OR&nbsp;'DR'&nbsp;OR&nbsp;'DX'&nbsp;OR&nbsp;'DZ'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;GT_BSEG&nbsp;INTO&nbsp;GS_BSEG.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MOVE-CORRESPONDING&nbsp;GS_DATA&nbsp;TO&nbsp;GS_FIT700.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIT700-CUSCODE&nbsp;=&nbsp;GS_BSEG-BPCODE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIT700-BLART&nbsp;&nbsp;&nbsp;=&nbsp;GS_BKPF-BLART.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIT700-BLDAT&nbsp;&nbsp;&nbsp;=&nbsp;GS_BKPF-BLDAT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIT700-BUDAT&nbsp;&nbsp;&nbsp;=&nbsp;GS_BKPF-BUDAT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;ZEA_FIT700&nbsp;FROM&nbsp;GS_FIT700.&nbsp;"&nbsp;아이템&nbsp;테이블&nbsp;=&gt;&nbsp;고객원장'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'KA'&nbsp;OR&nbsp;'KG'&nbsp;OR&nbsp;'KN'&nbsp;OR&nbsp;'KP'&nbsp;OR&nbsp;'KR'&nbsp;OR&nbsp;'KX'&nbsp;OR&nbsp;'KZ'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;GT_BSEG&nbsp;INTO&nbsp;GS_BSEG.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MOVE-CORRESPONDING&nbsp;GS_DATA&nbsp;TO&nbsp;GS_FIT800.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIT800-VENCODE&nbsp;=&nbsp;GS_BSEG-BPCODE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIT700-BLART&nbsp;&nbsp;&nbsp;=&nbsp;GS_BKPF-BLART.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIT700-BLDAT&nbsp;&nbsp;&nbsp;=&nbsp;GS_BKPF-BLDAT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIT700-BUDAT&nbsp;&nbsp;&nbsp;=&nbsp;GS_BKPF-BUDAT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;ZEA_FIT800&nbsp;FROM&nbsp;GS_FIT800.&nbsp;"&nbsp;아이템&nbsp;테이블&nbsp;=&gt;&nbsp;벤더원장'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
&nbsp;&nbsp;ENDCASE.<br />
<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;EQ&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;COMMIT&nbsp;WORK&nbsp;AND&nbsp;WAIT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;S123&nbsp;WITH&nbsp;GV_BELNR_NUMBER.<br />
   </div>
   <div class="codeComment">
*<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ENDIF.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;CLEAR_ALV<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM CLEAR_ALV .<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;GO_ALV_GRID-&gt;FREE.<br />
*&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;GO_CONTAINER-&gt;FREE.<br />
   </div>
   <div class="code">
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;CHECK_BEFORE_SAVE<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM CHECK_BEFORE_SAVE .<br />
<br />
&nbsp;&nbsp;IF&nbsp;S0100-DIFFERENC&nbsp;NE&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;MESSAGE&nbsp;를&nbsp;띄우면&nbsp;로직이&nbsp;EXIT.&nbsp;됨.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'Error&nbsp;:&nbsp;대차&nbsp;불일치로&nbsp;전표&nbsp;전기가&nbsp;불가합니다.&nbsp;전표를&nbsp;추가&nbsp;입력해주세요.'&nbsp;TYPE&nbsp;'I'&nbsp;DISPLAY&nbsp;LIKE&nbsp;'E'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;LEAVE&nbsp;SCREEN.<br />
<br />
   </div>
   <div class="codeComment">
**&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;MESSAGE&nbsp;-&gt;&nbsp;강제로&nbsp;PBO를&nbsp;돌린다.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;CL_GUI_CFW=&gt;SET_NEW_OK_CODE<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NEW_CODE&nbsp;=&nbsp;''.&nbsp;&nbsp;"&nbsp;New&nbsp;OK_CODE<br />
<br />
&nbsp;&nbsp;ELSEIF&nbsp;S0100-DIFFERENC&nbsp;EQ&nbsp;0&nbsp;AND&nbsp;S0100-SUM_S&nbsp;EQ&nbsp;0&nbsp;AND&nbsp;S0100-SUM_H&nbsp;EQ&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'Error&nbsp;:&nbsp;전표를&nbsp;입력해주세요.'&nbsp;TYPE&nbsp;'I'&nbsp;DISPLAY&nbsp;LIKE&nbsp;'E'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;:&nbsp;OK_CODE.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;DELETE_ITEM_DATA<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM DELETE_ITEM_DATA.<br />
<br />
&nbsp;&nbsp;ZEA_BSEG-DMBTR&nbsp;=&nbsp;0.<br />
   </div>
   <div class="codeComment">
*&nbsp;--&nbsp;1.&nbsp;itab에&nbsp;마지막&nbsp;라인을&nbsp;읽어온다.<br />
*&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;GT_BSEG&nbsp;INTO&nbsp;GS_DATA&nbsp;INDEX&nbsp;1.&nbsp;"&nbsp;&lt;==&nbsp;첫&nbsp;번째&nbsp;행을&nbsp;가져옴<br />
*&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;GT_BSEG&nbsp;INTO&nbsp;GS_DATA&nbsp;INDEX&nbsp;0.&nbsp;"&nbsp;&lt;==&nbsp;마지막&nbsp;행을&nbsp;가져옴<br />
<br />
*&nbsp;--&nbsp;2.&nbsp;삭제하시겠습니까?&nbsp;팝업창?<br />
   </div>
   <div class="code">
&nbsp;&nbsp;_MC_POPUP_CONFIRM&nbsp;'전표&nbsp;항목&nbsp;삭제'&nbsp;'입력한&nbsp;항목을&nbsp;삭제하시겠습니까?'&nbsp;GV_ANSWER.<br />
&nbsp;&nbsp;CHECK&nbsp;GV_ANSWER&nbsp;=&nbsp;'1'.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;--&nbsp;3.&nbsp;itab에서도&nbsp;삭제&nbsp;&&nbsp;삭제&nbsp;&gt;&nbsp;라인-1&nbsp;반영<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;"&nbsp;방법1.&nbsp;itab&nbsp;:&nbsp;가장&nbsp;마지막&nbsp;라인&nbsp;삭제&nbsp;구현<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;SORT&nbsp;GT_BSEG&nbsp;BY&nbsp;ITNUM&nbsp;DESCENDING.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;"&nbsp;방법2.&nbsp;itab&nbsp;:&nbsp;내가&nbsp;선택한&nbsp;라인&nbsp;삭제&nbsp;구현<br />
&nbsp;&nbsp;DATA:&nbsp;BEGIN&nbsp;OF&nbsp;LS_DEL_KEYS,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BUKRS&nbsp;&nbsp;&nbsp;TYPE&nbsp;ZEA_BSEG-BUKRS,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GJAHR&nbsp;&nbsp;&nbsp;TYPE&nbsp;ZEA_BSEG-GJAHR,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITNUM&nbsp;&nbsp;&nbsp;TYPE&nbsp;ZEA_BSEG-ITNUM,<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&nbsp;금액을&nbsp;삭제해주기&nbsp;위해&nbsp;추가한&nbsp;필드<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DMBTR&nbsp;&nbsp;&nbsp;TYPE&nbsp;ZEA_BSEG-DMBTR,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BSCHL&nbsp;&nbsp;&nbsp;TYPE&nbsp;ZEA_TBSL-BSCHL,&nbsp;&nbsp;&nbsp;"&nbsp;전기키<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INDI_CD&nbsp;TYPE&nbsp;ZEA_TBSL-INDI_CD,&nbsp;"&nbsp;차대구분자<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;OF&nbsp;LS_DEL_KEYS.<br />
<br />
&nbsp;&nbsp;DATA&nbsp;LT_DEL_KEYS&nbsp;LIKE&nbsp;TABLE&nbsp;OF&nbsp;LS_DEL_KEYS.<br />
<br />
<br />
&nbsp;&nbsp;DATA&nbsp;LT_INDEX_ROWS&nbsp;TYPE&nbsp;LVC_T_ROW.<br />
&nbsp;&nbsp;DATA&nbsp;LS_INDEX_ROW&nbsp;LIKE&nbsp;LINE&nbsp;OF&nbsp;LT_INDEX_ROWS.<br />
<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;GO_ALV_GRID-&gt;GET_SELECTED_ROWS<br />
&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ET_INDEX_ROWS&nbsp;=&nbsp;LT_INDEX_ROWS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Indexes&nbsp;of&nbsp;Selected&nbsp;Rows<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ET_ROW_NO&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Numeric&nbsp;IDs&nbsp;of&nbsp;Selected&nbsp;Rows<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;.<br />
<br />
&nbsp;&nbsp;DATA&nbsp;LV_SUBRC&nbsp;TYPE&nbsp;I.<br />
&nbsp;&nbsp;DATA&nbsp;LV_COUNT&nbsp;TYPE&nbsp;I.<br />
&nbsp;&nbsp;DATA&nbsp;LV_INDI_CD&nbsp;TYPE&nbsp;C.<br />
<br />
&nbsp;&nbsp;IF&nbsp;LT_INDEX_ROWS[]&nbsp;IS&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;S000&nbsp;DISPLAY&nbsp;LIKE&nbsp;'W'&nbsp;WITH&nbsp;'최소&nbsp;한&nbsp;행이상&nbsp;선택하세요'.<br />
&nbsp;&nbsp;ELSE.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;LT_INDEX_ROWS&nbsp;INTO&nbsp;LS_INDEX_ROW&nbsp;WHERE&nbsp;ROWTYPE&nbsp;IS&nbsp;INITIAL.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;GT_DATA&nbsp;INTO&nbsp;GS_DATA&nbsp;INDEX&nbsp;LS_INDEX_ROW-INDEX.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;EQ&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LS_DEL_KEYS.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MOVE-CORRESPONDING&nbsp;GS_DATA&nbsp;TO&nbsp;LS_DEL_KEYS.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LS_DEL_KEYS&nbsp;TO&nbsp;LT_DEL_KEYS.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;LT_DEL_KEYS&nbsp;:&nbsp;금액&nbsp;필드도&nbsp;함께&nbsp;담긴다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;LT_DEL_KEYS&nbsp;INTO&nbsp;LS_DEL_KEYS.<br />
   </div>
   <div class="codeComment">
*&nbsp;--&nbsp;삭제한&nbsp;행&nbsp;읽어오기<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;GT_DATA&nbsp;INTO&nbsp;GS_DATA&nbsp;WITH&nbsp;KEY&nbsp;ITNUM&nbsp;=&nbsp;LS_DEL_KEYS-ITNUM.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MOVE-CORRESPONDING&nbsp;GS_DATA&nbsp;TO&nbsp;ZEA_BSEG.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;--&nbsp;전기키&nbsp;테이블로&nbsp;S/H&nbsp;구분<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;여기서&nbsp;GS_TBSL&nbsp;로&nbsp;삭제되는&nbsp;전기키&nbsp;값이&nbsp;삭제하는&nbsp;라인이&nbsp;아닌&nbsp;값이&nbsp;들어감&nbsp;(2024.05.12)<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;GT_TBSL&nbsp;INTO&nbsp;GS_TBSL&nbsp;WITH&nbsp;KEY&nbsp;BSCHL&nbsp;=&nbsp;LS_DEL_KEYS-BSCHL<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BSTXT&nbsp;=&nbsp;LS_DEL_KEYS-BSTXT<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INDI_CD&nbsp;=&nbsp;LS_DEL_KEYS-INDI_CD.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CASE&nbsp;GS_TBSL-INDI_CD.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'S'.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S0100-SUM_S&nbsp;=&nbsp;S0100-SUM_S&nbsp;-&nbsp;LS_DEL_KEYS-DMBTR.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'H'.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S0100-SUM_H&nbsp;=&nbsp;S0100-SUM_H&nbsp;-&nbsp;LS_DEL_KEYS-DMBTR.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDCASE.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;GT_DATA로&nbsp;변경하여&nbsp;삭제&nbsp;테스트&nbsp;(2024.05.13&nbsp;-&nbsp;확인)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;GT_DATA&nbsp;INTO&nbsp;GS_DATA&nbsp;WITH&nbsp;KEY&nbsp;BSCHL&nbsp;=&nbsp;LS_DEL_KEYS-BSCHL&nbsp;"&nbsp;전기키<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INDI_CD&nbsp;=&nbsp;LS_DEL_KEYS-INDI_CD.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CASE&nbsp;GS_DATA-INDI_CD.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'S'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S0100-SUM_S&nbsp;=&nbsp;S0100-SUM_S&nbsp;-&nbsp;LS_DEL_KEYS-DMBTR.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'H'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S0100-SUM_H&nbsp;=&nbsp;S0100-SUM_H&nbsp;-&nbsp;LS_DEL_KEYS-DMBTR.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDCASE.<br />
<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;--&nbsp;선택한&nbsp;행&nbsp;GT_BSEG&nbsp;itab&nbsp;에서&nbsp;삭제<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;GT_DATA<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;BUKRS&nbsp;EQ&nbsp;LS_DEL_KEYS-BUKRS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;GJAHR&nbsp;EQ&nbsp;LS_DEL_KEYS-GJAHR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;ITNUM&nbsp;EQ&nbsp;LS_DEL_KEYS-ITNUM.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;NE&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADD&nbsp;SY-SUBRC&nbsp;TO&nbsp;LV_SUBRC.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LV_COUNT&nbsp;+=&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;차액&nbsp;계산<br />
&nbsp;&nbsp;&nbsp;&nbsp;S0100-DIFFERENC&nbsp;=&nbsp;S0100-SUM_S&nbsp;-&nbsp;S0100-SUM_H.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;LV_SUBRC&nbsp;EQ&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;S000&nbsp;WITH&nbsp;LV_COUNT&nbsp;'건의&nbsp;데이터가&nbsp;삭제되었습니다.'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GV_ITNUM&nbsp;-=&nbsp;LV_COUNT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZEA_BSEG-SAKNR&nbsp;=&nbsp;GS_DATA-SAKNR.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;ICON_CREATE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;REFRESH_TABLE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;S000&nbsp;DISPLAY&nbsp;LIKE&nbsp;'W'&nbsp;WITH&nbsp;'데이터&nbsp;삭제를&nbsp;실패하였습니다.'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_DATA.<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;GT_DATA&nbsp;INTO&nbsp;GS_DATA.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_DATA-ITNUM&nbsp;=&nbsp;SY-TABIX.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;GT_DATA&nbsp;FROM&nbsp;GS_DATA&nbsp;TRANSPORTING&nbsp;ITNUM.<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
<br />
<br />
   </div>
   <div class="codeComment">
**&nbsp;--&nbsp;&nbsp;&nbsp;비세그랑&nbsp;티비랑&nbsp;조인해가지고&nbsp;LV_INDI_CD에&nbsp;값을&nbsp;가져온다.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;*&nbsp;FROM&nbsp;ZEA_BSEG&nbsp;AS&nbsp;A<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JOIN&nbsp;ZEA_TBSL&nbsp;AS&nbsp;B&nbsp;ON&nbsp;B~BSCHL&nbsp;EQ&nbsp;A~BSCHL<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;GT_TBSL.<br />
<br />
*&nbsp;--&nbsp;삭제한&nbsp;행&nbsp;읽어오기<br />
***&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;GT_BSEG&nbsp;INTO&nbsp;GS_DATA&nbsp;INDEX&nbsp;LS_INDEX_ROW-INDEX.<br />
***<br />
***&nbsp;&nbsp;MOVE-CORRESPONDING&nbsp;GS_DATA&nbsp;TO&nbsp;ZEA_BSEG.<br />
***<br />
****&nbsp;--&nbsp;전기키&nbsp;테이블로&nbsp;S&nbsp;H&nbsp;구분<br />
***&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;GT_TBSL&nbsp;INTO&nbsp;GS_TBSL&nbsp;WITH&nbsp;KEY&nbsp;BSCHL&nbsp;=&nbsp;ZEA_BSEG-BSCHL.<br />
***<br />
***&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;GT_TBSL&nbsp;INTO&nbsp;GS_TBSL&nbsp;WITH&nbsp;KEY&nbsp;BSCHL&nbsp;=&nbsp;GS_DATA-BSCHL.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;LV_INDI_CD&nbsp;=&nbsp;GS_TBSL-INDI_CD.<br />
***<br />
***&nbsp;&nbsp;&nbsp;&nbsp;CASE&nbsp;LV_INDI_CD.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'S'.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S0100-SUM_S&nbsp;=&nbsp;S0100-SUM_S&nbsp;-&nbsp;GS_DATA-DMBTR&nbsp;-&nbsp;GS_DATA-EATAX.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'H'.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S0100-SUM_H&nbsp;=&nbsp;S0100-SUM_H&nbsp;-&nbsp;GS_DATA-DMBTR&nbsp;-&nbsp;GS_DATA-EATAX.<br />
***&nbsp;&nbsp;ENDCASE.<br />
***<br />
<br />
<br />
<br />
*&nbsp;--&nbsp;방법1.&nbsp;마지막&nbsp;행&nbsp;삭제&nbsp;로직<br />
*&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;GT_BSEG&nbsp;INTO&nbsp;GS_DATA&nbsp;INDEX&nbsp;1.&nbsp;"&nbsp;마지막&nbsp;행이&nbsp;담긴다.<br />
*<br />
*&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;GT_BSEG&nbsp;INTO&nbsp;GS_DATA.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;SY-TABIX&nbsp;=&nbsp;1.&nbsp;"&nbsp;GS_DATA의&nbsp;첫&nbsp;번째&nbsp;레코드일&nbsp;경우<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;GT_BSEG&nbsp;INDEX&nbsp;SY-TABIX.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXIT.&nbsp;"&nbsp;루프를&nbsp;종료합니다.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
*&nbsp;&nbsp;ENDLOOP.<br />
<br />
*&nbsp;--&nbsp;4.&nbsp;삭제한&nbsp;라인(마지막&nbsp;행)은&nbsp;금액합계에서&nbsp;차감시켜야&nbsp;한다.<br />
*&nbsp;&nbsp;PERFORM&nbsp;CARCULATION_DATA_MINUS_INDEX.<br />
<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;"&nbsp;삭제&nbsp;&gt;&nbsp;라인-1<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;GV_ITNUM&nbsp;=&nbsp;GV_ITNUM&nbsp;-&nbsp;1.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;"&nbsp;금액&nbsp;초기화<br />
&nbsp;&nbsp;CLEAR&nbsp;ZEA_BSEG-DMBTR.<br />
&nbsp;&nbsp;S0100-TAX&nbsp;=&nbsp;ABAP_OFF.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;--&nbsp;5.&nbsp;refresh&nbsp;-&nbsp;&nbsp;ALV&nbsp;Refresh<br />
   </div>
   <div class="code">
&nbsp;&nbsp;PERFORM&nbsp;REFRESH_TABLE.<br />
<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;--&nbsp;6.&nbsp;PBO&nbsp;돌리기<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;CL_GUI_CFW=&gt;SET_NEW_OK_CODE<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NEW_CODE&nbsp;=&nbsp;'ENTER'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;New&nbsp;OK_CODE<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;DISPLAY_SAVE_DATA<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM DISPLAY_SAVE_DATA .<br />
   </div>
   <div class="codeComment">
*&nbsp;--&nbsp;&nbsp;데이터가&nbsp;저장이&nbsp;되었는지&nbsp;확인&nbsp;(&nbsp;미저장된&nbsp;상태에서는&nbsp;조회불가&nbsp;)<br />
   </div>
   <div class="code">
&nbsp;&nbsp;IF&nbsp;GV_ANSWER&nbsp;NE&nbsp;'1'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'전표를&nbsp;저장한&nbsp;후&nbsp;조회가&nbsp;가능합니다.'&nbsp;TYPE&nbsp;'I'&nbsp;DISPLAY&nbsp;LIKE&nbsp;'E'.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;CHECK&nbsp;GV_ANSWER&nbsp;=&nbsp;'1'.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;--&nbsp;ZEA_GL_DIS&nbsp;트랜잭션&nbsp;호출&nbsp;-&nbsp;전달&nbsp;값은&nbsp;?&nbsp;회사코드&nbsp;전표번호<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;TRANSACTION&nbsp;ZEA_GL_DIS.<br />
<br />
   </div>
   <div class="code">
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;CARCULATION_DATA_MINUS_INDEX<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM CARCULATION_DATA_MINUS_INDEX .<br />
   </div>
   <div class="codeComment">
****<br />
****&nbsp;&nbsp;"&nbsp;차/대변&nbsp;합계&nbsp;계산&nbsp;&&nbsp;STATUS&nbsp;ICON&nbsp;설정<br />
****&nbsp;&nbsp;PERFORM&nbsp;CALCULATION_DATA.<br />
<br />
*&nbsp;--&nbsp;삭제한&nbsp;행&nbsp;읽어오기<br />
   </div>
   <div class="code">
&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;GT_BSEG&nbsp;INTO&nbsp;GS_DATA&nbsp;INDEX&nbsp;1.<br />
<br />
&nbsp;&nbsp;MOVE-CORRESPONDING&nbsp;GS_DATA&nbsp;TO&nbsp;ZEA_BSEG.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;--&nbsp;전기키&nbsp;테이블로&nbsp;S&nbsp;H&nbsp;구분<br />
   </div>
   <div class="code">
&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;GT_TBSL&nbsp;INTO&nbsp;GS_TBSL&nbsp;WITH&nbsp;KEY&nbsp;BSCHL&nbsp;=&nbsp;ZEA_BSEG-BSCHL.<br />
<br />
&nbsp;&nbsp;"&nbsp;부가세도&nbsp;함께&nbsp;빼줘야한다.<br />
&nbsp;&nbsp;CASE&nbsp;GS_TBSL-INDI_CD.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'S'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S0100-SUM_S&nbsp;=&nbsp;S0100-SUM_S&nbsp;-&nbsp;ZEA_BSEG-DMBTR.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'H'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S0100-SUM_H&nbsp;=&nbsp;S0100-SUM_H&nbsp;-&nbsp;ZEA_BSEG-DMBTR.<br />
&nbsp;&nbsp;ENDCASE.<br />
   </div>
   <div class="codeComment">
**&nbsp;&nbsp;CASE&nbsp;ZEA_BSEG-BSCHL.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'40'.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S0100-SUM_S&nbsp;=&nbsp;S0100-SUM_S&nbsp;+&nbsp;ZEA_BSEG-DMBTR.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'50'.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;S0100-SUM_H&nbsp;=&nbsp;S0100-SUM_H&nbsp;+&nbsp;ZEA_BSEG-DMBTR.<br />
**&nbsp;&nbsp;ENDCASE.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;IF&nbsp;S0100-DIFFERENC&nbsp;NE&nbsp;0.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'ICON_CREATE'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NAME&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ICON_LED_RED<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'대차&nbsp;불일치'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RESULT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;STATUS_ICON<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ICON_NOT_FOUND&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1&nbsp;"&nbsp;Icon&nbsp;name&nbsp;unknown&nbsp;to&nbsp;system<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OUTPUTFIELD_TOO_SHORT&nbsp;=&nbsp;2.&nbsp;"&nbsp;Length&nbsp;of&nbsp;field&nbsp;'RESULT'&nbsp;is&nbsp;too&nbsp;small<br />
<br />
&nbsp;&nbsp;ELSE.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'ICON_CREATE'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NAME&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ICON_LED_GREEN<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'대차&nbsp;일치'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RESULT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;STATUS_ICON<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ICON_NOT_FOUND&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1&nbsp;"&nbsp;Icon&nbsp;name&nbsp;unknown&nbsp;to&nbsp;system<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OUTPUTFIELD_TOO_SHORT&nbsp;=&nbsp;2&nbsp;"&nbsp;Length&nbsp;of&nbsp;field&nbsp;'RESULT'&nbsp;is&nbsp;too&nbsp;small<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;3.<br />
&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;MODIFY&nbsp;SCREEN.<br />
<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;REFRESH_0100<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM REFRESH_0100 .<br />
&nbsp;&nbsp;CLEAR:&nbsp;ZEA_BKPF,&nbsp;ZEA_BSEG,&nbsp;ZEA_SKB1,&nbsp;ZEA_TBSL,&nbsp;S0100.<br />
&nbsp;&nbsp;REFRESH:&nbsp;GT_BKPF[],&nbsp;GT_BSEG[],&nbsp;GT_TBSL[].<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;SCREEN.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CASE&nbsp;SCREEN-GROUP1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'GR1'.&nbsp;"&nbsp;INPUT&nbsp;필드<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SCREEN-INPUT&nbsp;=&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'GR2'.&nbsp;"&nbsp;INPUT&nbsp;&&nbsp;REQUIRE&nbsp;필드<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SCREEN-INPUT&nbsp;=&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SCREEN-REQUIRED&nbsp;=&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDCASE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;SCREEN.<br />
&nbsp;&nbsp;ENDLOOP.<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;ON_DELETE_DATA<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM ON_DELETE_DATA  USING    PO_UCOMM.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;SAVE_ALL_DATA<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM SAVE_ALL_DATA .<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;--&nbsp;발행된&nbsp;전표번호가가&nbsp;있는지&nbsp;확인<br />
   </div>
   <div class="code">
&nbsp;&nbsp;"&nbsp;전표번호가&nbsp;발행되었다면&nbsp;저장버튼을&nbsp;누른것<br />
&nbsp;&nbsp;IF&nbsp;ZEA_BKPF-BELNR&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'전표가&nbsp;이미&nbsp;발행되었습니다.&nbsp;이전단계에서&nbsp;전표를&nbsp;다시&nbsp;생성해주세요.'&nbsp;TYPE&nbsp;'I'&nbsp;DISPLAY&nbsp;LIKE&nbsp;'E'.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;LEAVE&nbsp;PROGRAM.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;--&nbsp;전표번호가&nbsp;발행되지&nbsp;않았다면,&nbsp;신규&nbsp;생성&nbsp;데이터.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CHECK&nbsp;ZEA_BKPF-BELNR&nbsp;IS&nbsp;INITIAL.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;--&nbsp;&nbsp;차/대변&nbsp;불일치&nbsp;시,&nbsp;에러메세지&nbsp;(TYEP&nbsp;'I')<br />
   </div>
   <div class="code">
&nbsp;&nbsp;PERFORM&nbsp;CHECK_BEFORE_SAVE.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;--&nbsp;&nbsp;합계&nbsp;일치인지&nbsp;점검&nbsp;(&nbsp;합계&nbsp;일치해야만&nbsp;아래&nbsp;로직&nbsp;실행됨&nbsp;)<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CHECK&nbsp;S0100-SUM_S&nbsp;NE&nbsp;0&nbsp;AND&nbsp;S0100-SUM_H&nbsp;NE&nbsp;0&nbsp;AND&nbsp;S0100-DIFFERENC&nbsp;EQ&nbsp;0.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;--&nbsp;&nbsp;저장여부&nbsp;팝업창&nbsp;호출<br />
   </div>
   <div class="code">
&nbsp;&nbsp;_MC_POPUP_CONFIRM&nbsp;'SAVE'&nbsp;'전표를&nbsp;발행하시겠습니까?'&nbsp;GV_ANSWER.<br />
&nbsp;&nbsp;CASE&nbsp;GV_ANSWER.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'1'.&nbsp;"&nbsp;YES<br />
   </div>
   <div class="codeComment">
*&nbsp;--&nbsp;차/대변&nbsp;일치할&nbsp;때만&nbsp;&nbsp;헤더&아이템&nbsp;테이블&nbsp;저장<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;SAVE_TABLE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;GT_BKPF&nbsp;INTO&nbsp;GS_BKPF&nbsp;INDEX&nbsp;1.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SET&nbsp;PARAMETER&nbsp;ID&nbsp;'ZEA_BELNR'&nbsp;FIELD&nbsp;GS_BSEG-BELNR.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;TRANSACTION&nbsp;'ZEA_FI020'.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;SKIP&nbsp;FIRST&nbsp;SCREEN.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'2'.&nbsp;"&nbsp;NO<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;OTHERS.&nbsp;"&nbsp;Cancel&nbsp;일때.<br />
<br />
&nbsp;&nbsp;ENDCASE.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;ICON_CREATE<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM ICON_CREATE.<br />
<br />
&nbsp;&nbsp;IF&nbsp;S0100-DIFFERENC&nbsp;NE&nbsp;0.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'ICON_CREATE'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NAME&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ICON_LED_RED<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'대차&nbsp;불일치'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RESULT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;STATUS_ICON<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ICON_NOT_FOUND&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1&nbsp;"&nbsp;Icon&nbsp;name&nbsp;unknown&nbsp;to&nbsp;system<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OUTPUTFIELD_TOO_SHORT&nbsp;=&nbsp;2.&nbsp;"&nbsp;Length&nbsp;of&nbsp;field&nbsp;'RESULT'&nbsp;is&nbsp;too&nbsp;small<br />
<br />
&nbsp;&nbsp;ELSE.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'ICON_CREATE'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NAME&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ICON_LED_GREEN<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'대차&nbsp;일치'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RESULT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;STATUS_ICON<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ICON_NOT_FOUND&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1&nbsp;"&nbsp;Icon&nbsp;name&nbsp;unknown&nbsp;to&nbsp;system<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OUTPUTFIELD_TOO_SHORT&nbsp;=&nbsp;2&nbsp;"&nbsp;Length&nbsp;of&nbsp;field&nbsp;'RESULT'&nbsp;is&nbsp;too&nbsp;small<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;3.<br />
&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;MODIFY&nbsp;SCREEN.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;AMT_CONV_TO_EXTERNAL<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM AMT_CONV_TO_EXTERNAL  USING    P_W_WAERS " KRW<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;P_DMBTR.&nbsp;&nbsp;"&nbsp;금액<br />
<br />
   </div>
   <div class="codeComment">
***&nbsp;&nbsp;DATA:&nbsp;L_INTERNAL&nbsp;TYPE&nbsp;BAPICURR-BAPICURR,<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L_EXTERNAL&nbsp;TYPE&nbsp;BAPICURR-BAPICURR.<br />
***<br />
***&nbsp;&nbsp;L_INTERNAL&nbsp;=&nbsp;P_DMBTR.&nbsp;&nbsp;"금액이&nbsp;들어간다.<br />
***<br />
***&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'BAPI_CURRENCY_CONV_TO_EXTERNAL'<br />
***&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CURRENCY&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;P_W_WAERS&nbsp;&nbsp;&nbsp;"통화가&nbsp;들어간다.&nbsp;KRW&nbsp;겠지<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AMOUNT_INTERNAL&nbsp;=&nbsp;L_INTERNAL&nbsp;"100.00이&nbsp;들어간다.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AMOUNT_EXTERNAL&nbsp;=&nbsp;L_INTERNAL.&nbsp;"10000이&nbsp;나온다.<br />
***<br />
***&nbsp;&nbsp;P_DMBTR&nbsp;=&nbsp;L_INTERNAL&nbsp;/&nbsp;100.&nbsp;"&nbsp;다시&nbsp;원래&nbsp;INTERFACE&nbsp;할&nbsp;필드에&nbsp;넣은것이다.<br />
<br />
<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;DATA:&nbsp;L_INTERNAL&nbsp;TYPE&nbsp;BAPICURR-BAPICURR,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L_EXTERNAL&nbsp;TYPE&nbsp;BAPICURR-BAPICURR.<br />
<br />
&nbsp;&nbsp;L_INTERNAL&nbsp;=&nbsp;P_DMBTR.&nbsp;&nbsp;"&nbsp;입력된&nbsp;금액<br />
<br />
&nbsp;&nbsp;"&nbsp;KRW(대한민국&nbsp;원)의&nbsp;경우&nbsp;소수점&nbsp;이하&nbsp;자리를&nbsp;사용하지&nbsp;않으므로&nbsp;*&nbsp;100&nbsp;처리하지&nbsp;않음<br />
&nbsp;&nbsp;IF&nbsp;P_W_WAERS&nbsp;=&nbsp;'KRW'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'BAPI_CURRENCY_CONV_TO_EXTERNAL'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CURRENCY&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;P_W_WAERS&nbsp;&nbsp;&nbsp;"&nbsp;통화&nbsp;코드&nbsp;(예:&nbsp;KRW)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AMOUNT_INTERNAL&nbsp;=&nbsp;L_INTERNAL&nbsp;"&nbsp;입력된&nbsp;금액<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AMOUNT_EXTERNAL&nbsp;=&nbsp;L_INTERNAL.&nbsp;"&nbsp;외부&nbsp;통화로&nbsp;변환된&nbsp;금액<br />
&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;기타&nbsp;통화는&nbsp;*&nbsp;100&nbsp;처리<br />
&nbsp;&nbsp;&nbsp;&nbsp;L_INTERNAL&nbsp;=&nbsp;L_INTERNAL&nbsp;*&nbsp;100.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'BAPI_CURRENCY_CONV_TO_EXTERNAL'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CURRENCY&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;P_W_WAERS&nbsp;&nbsp;&nbsp;"&nbsp;통화&nbsp;코드<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AMOUNT_INTERNAL&nbsp;=&nbsp;L_INTERNAL&nbsp;"&nbsp;입력된&nbsp;금액<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AMOUNT_EXTERNAL&nbsp;=&nbsp;L_INTERNAL.&nbsp;"&nbsp;외부&nbsp;통화로&nbsp;변환된&nbsp;금액<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;"&nbsp;외부&nbsp;통화로&nbsp;변환된&nbsp;금액을&nbsp;원래&nbsp;인터페이스&nbsp;필드에&nbsp;할당<br />
&nbsp;&nbsp;P_DMBTR&nbsp;=&nbsp;L_INTERNAL.<br />
<br />
<br />
<br />
<br />
ENDFORM.                                          " AMT_CONV_TO_EXTERNAL<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;BACK<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM BACK .<br />
&nbsp;&nbsp;IF&nbsp;GV_CHANGED&nbsp;EQ&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;&nbsp;&nbsp;_MC_POPUP_CONFIRM&nbsp;'SAVE'&nbsp;'변경된&nbsp;데이터를&nbsp;저장하시겠습니까?'&nbsp;GV_ANSWER.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;YES를&nbsp;누른&nbsp;경우&nbsp;DATA_SAVE를&nbsp;수행<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;GV_ANSWER&nbsp;EQ&nbsp;'1'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;SAVE_TABLE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEAVE&nbsp;TO&nbsp;SCREEN&nbsp;0.&nbsp;"&nbsp;100번&nbsp;프로그램<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;CANCEL을&nbsp;누른&nbsp;경우&nbsp;로직을&nbsp;수행하지&nbsp;않는다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;GV_ANSWER&nbsp;EQ&nbsp;'A'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;NO를&nbsp;누른경우&nbsp;이전&nbsp;화면으로&nbsp;돌아간다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEAVE&nbsp;TO&nbsp;SCREEN&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;LEAVE&nbsp;TO&nbsp;SCREEN&nbsp;0.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;INPUT_CHECK<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM INPUT_CHECK .<br />
<br />
&nbsp;&nbsp;DATA&nbsp;:&nbsp;LV_BSCHL&nbsp;TYPE&nbsp;ZEA_TBSL-BSCHL.<br />
<br />
&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;BSCHL&nbsp;FROM&nbsp;ZEA_TBSL&nbsp;INTO&nbsp;LV_BSCHL<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;BSCHL&nbsp;EQ&nbsp;ZEA_TBSL-BSCHL.<br />
<br />
&nbsp;&nbsp;"&nbsp;현재&nbsp;떠있는&nbsp;화면에서&nbsp;특정&nbsp;필드의&nbsp;값을&nbsp;읽어오는&nbsp;함수&nbsp;및&nbsp;방법<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'DYNP_VALUES_READ'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DYNAME&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'ZEA_FI030'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;화면이&nbsp;소속된&nbsp;프로그램&nbsp;명<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DYNUMB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;SY-DYNNR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;화면&nbsp;번호<br />
*&nbsp;&nbsp;&nbsp;&nbsp;TABLES<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DYNPFIELDS&nbsp;=&nbsp;ZEA_TBSL-BSCHL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;export&nbsp;:&nbsp;읽어들일&nbsp;필드&nbsp;명<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;import&nbsp;:&nbsp;준&nbsp;필드&nbsp;명의&nbsp;값<br />
*&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;01.<br />
<br />
*&nbsp;&nbsp;IF&nbsp;LV_BSCHL&nbsp;IS&nbsp;INITIAL.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'올바른&nbsp;전기키를&nbsp;입력해주세요'&nbsp;TYPE&nbsp;'E'.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'SAPGUI_SET_FUNCTIONCODE'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FUNCTIONCODE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;''<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FUNCTION_NOT_SUPPORTED&nbsp;=&nbsp;1<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2.<br />
*<br />
*&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;"&nbsp;화면&nbsp;:&nbsp;ZEA_TBSL-BSCHL<br />
<br />
ENDFORM. " INPUT_CHECK= 전기키 값 체크<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;HANDLE_TOOLBAR<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM HANDLE_TOOLBAR  USING PO_OBJECT TYPE REF TO CL_ALV_EVENT_TOOLBAR_SET<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PO_SENDER&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;CL_GUI_ALV_GRID.<br />
<br />
&nbsp;&nbsp;DATA&nbsp;LS_TOOLBAR&nbsp;LIKE&nbsp;LINE&nbsp;OF&nbsp;PO_OBJECT-&gt;MT_TOOLBAR.<br />
<br />
<br />
&nbsp;&nbsp;CASE&nbsp;PO_SENDER.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;GO_ALV_GRID.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;구분자<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LS_TOOLBAR.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_TOOLBAR-BUTN_TYPE&nbsp;=&nbsp;3.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LS_TOOLBAR&nbsp;TO&nbsp;PO_OBJECT-&gt;MT_TOOLBAR.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;버튼&nbsp;추가<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LS_TOOLBAR.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_TOOLBAR-BUTN_TYPE&nbsp;=&nbsp;0.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_TOOLBAR-FUNCTION&nbsp;=&nbsp;'FC_ADD'.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_TOOLBAR-TEXT&nbsp;=&nbsp;TEXT-L01.&nbsp;"&nbsp;항목&nbsp;추가<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_TOOLBAR-ICON&nbsp;=&nbsp;ICON_INSERT_ROW.&nbsp;"&nbsp;항목&nbsp;추가<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LS_TOOLBAR&nbsp;TO&nbsp;PO_OBJECT-&gt;MT_TOOLBAR.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LS_TOOLBAR.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_TOOLBAR-BUTN_TYPE&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_TOOLBAR-FUNCTION&nbsp;=&nbsp;'FC_DEL'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_TOOLBAR-TEXT&nbsp;=&nbsp;TEXT-L02.&nbsp;"&nbsp;항목&nbsp;삭제<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_TOOLBAR-ICON&nbsp;=&nbsp;ICON_DELETE_ROW.&nbsp;"&nbsp;항목&nbsp;삭제<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LS_TOOLBAR&nbsp;TO&nbsp;PO_OBJECT-&gt;MT_TOOLBAR.<br />
<br />
&nbsp;&nbsp;ENDCASE.<br />
<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;HANDLE_USER_COMMAND<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM HANDLE_USER_COMMAND USING PV_UCOMM  TYPE SY-UCOMM<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PO_SENDER&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;CL_GUI_ALV_GRID.<br />
<br />
&nbsp;&nbsp;CASE&nbsp;PO_SENDER.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;GO_ALV_GRID.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CASE&nbsp;PV_UCOMM.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'FC_ADD'.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;SAVE_ITEM_DATA.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'FC_DEL'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OK_CODE&nbsp;=&nbsp;'FC_DEL'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;DELETE_ITEM_DATA.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDCASE.<br />
&nbsp;&nbsp;ENDCASE.<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;CREATE_OBJECT_300<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM CREATE_OBJECT_300 .<br />
<br />
&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;GO_CONTAINER300<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTAINER_NAME&nbsp;=&nbsp;'CCON'<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1.<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;GO_ALV_GRID300<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_PARENT&nbsp;=&nbsp;GO_CONTAINER300<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;=&nbsp;1.<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;DISPLAY_300<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM DISPLAY_300 .<br />
<br />
&nbsp;&nbsp;GS_VARIANT-REPORT&nbsp;=&nbsp;SY-REPID.<br />
&nbsp;&nbsp;GV_SAVE&nbsp;=&nbsp;'A'.<br />
<br />
&nbsp;&nbsp;GO_ALV_GRID300-&gt;SET_TABLE_FOR_FIRST_DISPLAY(<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_STRUCTURE_NAME&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'ZEA_SKA1'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_SAVE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GV_SAVE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Save&nbsp;Layout<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IS_LAYOUT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GS_LAYOUT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Layout<br />
&nbsp;&nbsp;&nbsp;&nbsp;CHANGING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_OUTTAB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GT_SKA1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Output&nbsp;Table<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_FIELDCATALOG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Field&nbsp;Catalog<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1<br />
&nbsp;&nbsp;).<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;SET_ALV_LAYOUT_300<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM SET_ALV_LAYOUT_300 .<br />
&nbsp;&nbsp;GS_LAYOUT-ZEBRA&nbsp;=&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;GS_LAYOUT-SEL_MODE&nbsp;=&nbsp;'D'.<br />
&nbsp;&nbsp;GS_LAYOUT-CWIDTH_OPT&nbsp;=&nbsp;ABAP_ON.<br />
ENDFORM.<br />
            </div>
          </td>
        </tr>
      </table>
      </td>
      </tr>
   <tr>
<td class="footer">Extracted by Mass Download version 1.5.5 - E.G.Mellodew. 1998-2024. Sap Release 754</td>
   </tr>
</table>
</body>
</html>
